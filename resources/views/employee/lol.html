<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>User Dashboard - HR Portal</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <style>
        body {
            background-color: #f4f6f9;
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .dashboard-header {
            background-color: #0d6efd;
            color: white;
            padding: 1.5rem;
            border-radius: 0 0 15px 15px;
        }
        .datetime-punch {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }
        .datetime {
            font-size: 1.25rem;
            font-weight: 600;
        }
        .btn-punch {
            background-color: #ffc107;
            border: none;
            color: #212529;
            font-weight: 600;
            padding: 0.5rem 1.5rem;
            border-radius: 8px;
            transition: background-color 0.3s ease;
            white-space: nowrap;
        }
        .btn-punch:hover {
            background-color: #e0a800;
            color: #212529;
        }
        .content-section {
            margin-top: 1.5rem;
        }
        .events-calendar {
            display: flex;
            gap: 2rem;
            flex-wrap: wrap;
        }
        .events {
            flex: 1;
            min-width: 280px;
            background: white;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            box-shadow: 0 0 15px rgb(0 0 0 / 0.1);
        }
        .events h5 {
            margin-bottom: 1rem;
            font-weight: 700;
            color: #0d6efd;
        }
        .event-item {
            padding: 0.5rem 0;
            border-bottom: 1px solid #e9ecef;
        }
        .event-item:last-child {
            border-bottom: none;
        }
        .event-date-time {
            font-weight: 600;
            color: #212529;
        }
        .event-title {
            color: #495057;
        }
        .calendar {
            width: 320px;
            background: white;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            box-shadow: 0 0 15px rgb(0 0 0 / 0.1);
        }
        .calendar table {
            width: 100%;
            border-collapse: collapse;
            user-select: none;
        }
        .calendar th,
        .calendar td {
            text-align: center;
            padding: 0.5rem 0;
            cursor: default;
        }
        .calendar th {
            color: #0d6efd;
            font-weight: 700;
            border-bottom: 2px solid #0d6efd;
        }
        .calendar td {
            border-radius: 50%;
            transition: background-color 0.3s ease;
        }
        .calendar td.today {
            background-color: #0d6efd;
            color: white;
            font-weight: 700;
        }
        .calendar td:hover:not(.empty):not(.today) {
            background-color: #bee5ff;
            cursor: pointer;
        }
        .dashboard-cards {
            margin-top: 2rem;
            display: flex;
            gap: 1.5rem;
            flex-wrap: wrap;
            justify-content: space-between;
        }
        .card {
            flex: 1 1 300px;
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 0 15px rgb(0 0 0 / 0.1);
        }
        .card h4 {
            font-weight: 700;
            margin-bottom: 1rem;
            color: #0d6efd;
        }
        .card ul {
            list-style: none;
            padding-left: 0;
            color: #495057;
        }
        .card ul li {
            padding: 0.5rem 0;
            border-bottom: 1px solid #e9ecef;
        }
        .card ul li:last-child {
            border-bottom: none;
        }
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .events-calendar {
                flex-direction: column;
            }
            .calendar {
                width: 100%;
            }
            .dashboard-cards {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>

<div class="dashboard-header">
    <div class="container">
        <div class="datetime-punch">
            <div class="datetime" id="currentDateTime">
                <!-- Date & Time will appear here -->
            </div>
            <button class="btn-punch" id="punchInBtn">Punch In</button>
        </div>
    </div>
</div>

<div class="container content-section">

    <!-- Upcoming Events & Calendar -->
    <div class="events-calendar">
        <div class="events">
            <h5>Upcoming Events</h5>
            <div id="eventsList">
                <!-- Event items rendered here -->
            </div>
        </div>
        <div class="calendar" id="calendarContainer">
            <!-- Calendar rendered here -->
        </div>
    </div>

    <!-- Attendance, Leave, Task Summary -->
    <div class="dashboard-cards">
        <div class="card" id="attendanceCard">
            <h4>Attendance</h4>
            <ul>
                <li>Total Days Present: <span id="daysPresent">-</span></li>
                <li>Total Days Absent: <span id="daysAbsent">-</span></li>
                <li>Last Punch In: <span id="lastPunchIn">-</span></li>
            </ul>
        </div>
        <div class="card" id="leaveCard">
            <h4>Leave</h4>
            <ul>
                <li>Leave Balance: <span id="leaveBalance">-</span> days</li>
                <li>Pending Leave Requests: <span id="pendingLeave">-</span></li>
                <li>Approved Leaves: <span id="approvedLeaves">-</span></li>
            </ul>
        </div>
        <div class="card" id="taskCard">
            <h4>Tasks</h4>
            <ul>
                <li>Pending Tasks: <span id="pendingTasks">-</span></li>
                <li>Completed Tasks: <span id="completedTasks">-</span></li>
                <li>Overdue Tasks: <span id="overdueTasks">-</span></li>
            </ul>
        </div>
    </div>
</div>

<script>
    // Date and Time display
    function updateDateTime() {
        const now = new Date();
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        const dateStr = now.toLocaleDateString(undefined, options);
        const timeStr = now.toLocaleTimeString();
        document.getElementById('currentDateTime').textContent = `${dateStr} | ${timeStr}`;
    }
    setInterval(updateDateTime, 1000);
    updateDateTime();

    // Sample upcoming events data (would come from backend typically)
    const upcomingEvents = [
        { date: '2024-07-02', event: 'Team Meeting', time: '10:00 AM' },
        { date: '2024-07-05', event: 'Project Deadline', time: '5:00 PM' },
        { date: '2024-07-10', event: 'HR Training Session', time: '2:00 PM' },
    ];

    // Render upcoming events
    function renderEvents() {
        const container = document.getElementById('eventsList');
        if (upcomingEvents.length === 0) {
            container.innerHTML = '<p class="text-muted">No upcoming events.</p>';
            return;
        }
        container.innerHTML = upcomingEvents.map(ev => `
            <div class="event-item">
                <div class="event-date-time">${new Date(ev.date).toLocaleDateString()} - ${ev.time}</div>
                <div class="event-title">${ev.event}</div>
            </div>
        `).join('');
    }
    renderEvents();

    // Simple calendar rendering for current month
    function renderCalendar() {
        const calendarContainer = document.getElementById('calendarContainer');
        const now = new Date();
        const year = now.getFullYear();
        const month = now.getMonth();

        const firstDay = new Date(year, month, 1).getDay(); // day of week (0=Sunday)
        const daysInMonth = new Date(year, month + 1, 0).getDate();

        const monthName = now.toLocaleString(undefined, { month: 'long' });

        let html = `<table aria-label="Calendar for ${monthName} ${year}">
            <thead>
                <tr><th colspan="7" class="fw-bold">${monthName} ${year}</th></tr>
                <tr>
                    <th>Sun</th><th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th><th>Fri</th><th>Sat</th>
                </tr>
            </thead>
            <tbody><tr>`;

        // Fill in blank cells before first day
        for (let i = 0; i < firstDay; i++) {
            html += '<td class="empty"></td>';
        }

        // Fill in days
        for (let day = 1; day <= daysInMonth; day++) {
            const isToday = day === now.getDate();
            html += `<td class="${isToday ? 'today' : ''}">${day}</td>`;
            if ((firstDay + day) % 7 === 0) {
                html += '</tr><tr>';
            }
        }

        // Fill remaining cells to complete the last week
        const lastWeekDayCount = (firstDay + daysInMonth) % 7;
        if (lastWeekDayCount !== 0) {
            for (let i = lastWeekDayCount; i < 7; i++) {
                html += '<td class="empty"></td>';
            }
        }

        html += '</tr></tbody></table>';
        calendarContainer.innerHTML = html;
    }
    renderCalendar();

    // Punch In button handler
    document.getElementById('punchInBtn').addEventListener('click', () => {
        alert('Punch In recorded at ' + new Date().toLocaleTimeString());
        // TODO: Implement actual punch in logic (AJAX to backend)
    });

    // Sample attendance, leave and tasks data (replace with real data from backend)
    const attendanceData = {
        daysPresent: 18,
        daysAbsent: 2,
        lastPunchIn: '2024-06-25 08:45 AM'
    };

    const leaveData = {
        leaveBalance: 12,
        pendingLeave: 1,
        approvedLeaves: 4
    };

    const taskData = {
        pendingTasks: 3,
        completedTasks: 7,
        overdueTasks: 1
    };

    // Render summary cards
    document.getElementById('daysPresent').textContent = attendanceData.daysPresent;
    document.getElementById('daysAbsent').textContent = attendanceData.daysAbsent;
    document.getElementById('lastPunchIn').textContent = attendanceData.lastPunchIn;

    document.getElementById('leaveBalance').textContent = leaveData.leaveBalance;
    document.getElementById('pendingLeave').textContent = leaveData.pendingLeave;
    document.getElementById('approvedLeaves').textContent = leaveData.approvedLeaves;

    document.getElementById('pendingTasks').textContent = taskData.pendingTasks;
    document.getElementById('completedTasks').textContent = taskData.completedTasks;
    document.getElementById('overdueTasks').textContent = taskData.overdueTasks;

</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>